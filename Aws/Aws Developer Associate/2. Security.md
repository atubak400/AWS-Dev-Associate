## Security

### 1. IAM Policy with Explicit Deny for Specific Object Names

{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "s3:*",
            "Resource":   [
            "arn:aws:s3:::mycustomerdata/*”,
            "arn:aws:s3:::mycustomerdata/”
    ]
        },
     {
            "Sid": "DenyS3Logs",
            "Effect": "Deny",
            "Action": "s3:DeleteObject",
            "Resource": "arn:aws:s3:::mycustomerdata/*log*”
        }
    ]
}

- This IAM policy allows full access to the mycustomerdata bucket, including all objects, but explicitly denies the ability to delete objects containing "log" in their names. This approach uses an explicit deny statement to prevent deletion of specific objects, while still allowing other actions across the bucket and its objects.

### 2. Ensuring Encrypted AMI Compliance

- To meet the security requirement for encrypted AMIs, create a copy of the existing AMI and enable encryption during the copy process. This ensures that all future EC2 instances launched from this AMI will use encrypted volumes, meeting the security standards for production deployments.

- It is not possible to encrypt an AMI after it has been created. You will need to create a copy of the AMI and add encryption for the copy.

### 3. Using IAM Roles for EC2 to Access S3 Securely

- To enable secure access to S3 from an EC2 instance, create an IAM role with read permissions for S3 and assign the role to the instance. This allows the instance to obtain temporary, automatically rotated credentials, improving security by avoiding static credentials on the instance.

### 4. Providing Temporary and Secure Access in AWS

- For one-time access to a specific resource, create an IAM user with only the necessary permissions and delete it once the task is complete. This approach ensures security by following the principle of least privilege and avoids the risks associated with shared or overly broad access.

### 5. Ensuring HTTPS with CloudFront Viewer Protocol Policy

- To secure a CloudFront distribution by enforcing HTTPS for all user requests, set the viewer protocol policy to "Redirect HTTP to HTTPS." This configuration ensures that all requests to CloudFront are encrypted, protecting data transmitted between users and CloudFront, which is essential for secure applications like online banking.
- There is no request protocol policy in CloudFront; this is not a valid setting.

### 6. Enforcing Encryption in S3 Using Bucket Policies

- To ensure that all uploaded files to an S3 bucket are encrypted, configure a bucket policy that only allows PUT operations with the x-amz-server-side-encryption parameter in the request header. This approach automatically enforces encryption, preventing unencrypted files from being stored in the bucket, and meets security requirements effectively.

### 7. Lambda and Dynamo distribution

- In order to write to a DynamoDB table, the Lambda function execution role needs to be configured with the proper permissions to write to the table; otherwise, a permission denied error will be thrown.

### 8. Using Cognito for Third-Party Authentication

- For secure and scalable integration with social identity providers like Facebook, use Amazon Cognito as an identity broker. Cognito simplifies user authentication, securely manages access, and provides temporary AWS credentials, making it ideal for mobile applications needing third-party authentication without custom broker implementations or hardcoded credentials.

### 9. Using Inline Policies for User-Specific Access Control

- For access that should be exclusive to a single IAM user, use an inline policy. Inline policies are embedded directly within a specific user, group, or role, ensuring that the policy cannot be mistakenly attached to other users. This approach supports precise access control, particularly for sensitive or restricted roles.

### 10. Secrets Manager

- AWS Secrets Manager is the current AWS-recommended way to securely provide database credentials to Lambda functions. AWS Secrets Manager aids in the managing and rotating of the RDS database passwords.

### 11. Protocols for Secure Access to AWS CodeCommit

- For secure access to AWS CodeCommit repositories, use SSH or HTTPS. SSH uses key pairs for authentication, while HTTPS leverages AWS access keys, ensuring secure and flexible connection options to manage your repositories.

### 12. Enabling Lambda Access to EC2 Instances in a VPC

- To enable an existing Lambda function to access EC2 instances within a private VPC, you need to modify the Lambda function’s configuration to specify the correct subnets and security groups. This ensures that the Lambda function runs within the private VPC, allowing it to communicate with EC2 instances located in that VPC, as long as the security groups permit the required network traffic.

### 13. Configuring HTTPS for CloudFront with Custom TLS Certificates

- When using AWS Certificate Manager (ACM) with CloudFront, the TLS certificate must be created in the us-east-1 (N. Virginia) Region. CloudFront only recognizes ACM certificates from this Region for HTTPS connections. This requirement applies even if your CloudFront distribution's origin is in a different Region.

### 14. Configuring Mobile App Permissions using IAM Roles and Amazon Cognito

- The AWS-recommended method for configuring permissions in a mobile application is to use Amazon Cognito(federated users) in combination with IAM roles. This setup allows federated users (e.g., users authenticated through social identity providers or through Cognito itself) to assume a specific IAM role that grants access to DynamoDB. This way, the mobile application can securely read data from DynamoDB without exposing static AWS credentials.

### 15. Setting Up a Static Website on Amazon S3
- The correct steps to set up a simple static website on Amazon S3 are:

    1. Create the S3 bucket: Start by creating the bucket in the AWS Region closest to your main audience, and name it to match your domain if desired (e.g., www.yourdomain.com).

    2. Enable static website hosting: Once the bucket is created, go to the Properties tab of the bucket and enable static website hosting. 2b. Specify the index document (e.g., index.html) and the error document if needed.

    3. Edit Block Public Access settings: Under Permissions, disable Block Public Access to allow the bucket to be publicly accessible.

    4. Add a public bucket policy: After adjusting the Block Public Access settings, add a bucket policy that allows public GET requests. This policy enables anyone to access the files in the bucket.

    5. Upload website files: Finally, upload your index.html, error.html, and any other necessary static content.

### 16. Lambda Alias

- AWS Lambda aliases provide a way to manage versions of Lambda functions, making it easy to deploy new versions gradually. By using a traffic-shifting alias, you can direct a specific percentage of traffic to a new version while the rest goes to the stable version. This enables you to monitor the performance of the new version with a small subset of users, minimizing risk.

- To safely deploy new versions of Lambda functions, use a Lambda alias configured for traffic shifting. If the new version performs as expected, you can increase traffic over time. If any issues occur, you can roll back by updating the alias to direct all traffic to the previous stable version, ensuring minimal downtime.

### 17. Cognito User Pools & Identity Pools

- User Pools = Who are you? (manages users and authentication), and Identity Pools = What can you do? (provides permissions to AWS resources, i.e handles authorization).

- Cognito User Pools are mainly about user authentication. They help manage users, handle sign-up and sign-in, and return tokens (like JWTs) to prove that a user is logged in. This is where you would authenticate users and manage user accounts.

- Cognito Identity Pools are focused on providing temporary AWS credentials for users who are already authenticated. Once a user is logged in (for example, via a User Pool or even a social login like Facebook), the Identity Pool gives them temporary access to AWS resources like S3 or DynamoDB.

- Amazon Cognito User Pools provide user authentication and management for applications. They handle sign-up and sign-in processes and can return a JWT (JSON Web Token) upon successful authentication. This token can be used to authenticate requests in your application securely and is compatible with the AWS SDK for .NET.

- Cognito Identity Pools: While Cognito Identity Pools provide temporary AWS credentials to users authenticated through User Pools or federated identity providers, they do not directly handle user authentication or return JWTs. Instead, they focus on enabling authenticated users to access AWS resources.

### 18. Lambda Authorizer

- An Amazon API Gateway Lambda authorizer (formerly known as a custom authorizer) is a Lambda function that you provide to control access to your API. 

- A Lambda Authorizer (formerly known as a custom authorizer) is the ideal solution when you want to control access to your API Gateway using a 3rd party authorization mechanism. With a Lambda Authorizer, you can write custom authorization logic that checks with a third-party service to verify access tokens or other credentials. Based on the logic you define, it will return a policy allowing or denying access to API Gateway.

### 19. IAM Access Analyzer 

- AWS IAM Access Analyzer helps you identify the resources in your organization and accounts, such as Amazon S3 buckets or IAM roles, that are shared with an external entity

- IAM Access Analyzer helps identify resources that are shared outside of your AWS account by analyzing permissions and policies. For S3 buckets, it can quickly detect if a bucket is publicly accessible or shared with external accounts, alerting the developer to potential security risks. This tool provides an easy way to monitor bucket access and helps ensure that S3 buckets remain secure.

### 20. Route 53 Geolocation routing

- The Geolocation routing policy in Amazon Route 53 allows you to route traffic based on the geographic location of the users making the DNS queries. By configuring geolocation routing, you can direct Brazilian users to servers located in Brazil, while preventing access to these servers from users outside Brazil.

### 21. Managing SSL/TLS Certificates in AWS

- To deploy SSL/TLS server certificates for enabling HTTPS connections, use AWS Certificate Manager (ACM) or IAM. ACM is the preferred service for managing certificates, while IAM can be used to store third-party certificates for specific AWS services.

### 22. Statefulness of Security Groups vs. Network ACLs

- To successfully connect to a service on an EC2 instance, remember that Security Groups are stateful (only inbound rules are necessary for return traffic), while Network ACLs are stateless (you must configure both inbound and outbound rules for successful connections).

### 23. Single-tenant hardware

- Single-tenant hardware means a physical server that is used by only one customer. You don’t share the server with anyone else, so only your applications and data are on that machine. It’s like renting a whole house for yourself instead of just an apartment in a shared building.

- Dedicated Instances are virtual machines that run on hardware exclusively reserved for your use, so you don’t share the physical server with anyone else. AWS manages the hardware, and you don’t need to worry about specific server details.

- Dedicated Hosts also run on dedicated hardware, but with more control over the physical server. You can see and control how instances are placed on the physical server, which can help if you have software licenses that need specific cores or sockets. Dedicated Hosts are generally more expensive but provide more customization and visibility into the server setup.

### 24. Choosing Dedicated Instances for Cost-Effective Single-Tenancy

- To meet security requirements for single-tenant hardware while managing costs, use Dedicated Instances. They provide isolated hardware for compliance needs without the higher costs associated with Dedicated Hosts.

### 25. AWS Account root user and CloudFront Key Pairs

- For Amazon CloudFront, you use key pairs to create signed URLs for private content, such as when you want to distribute restricted content that someone paid for. IAM users can't create CloudFront key pairs. You must log in using root credentials to create key pairs.

- The AWS Account root user is the only entity allowed to create CloudFront Key Pairs, which are specifically used for securing private content distributed via CloudFront.

### 26. Enforcing Server-Side Encryption (SSE-S3) in S3

- To ensure all objects uploaded to an S3 bucket are encrypted with SSE-S3, use the x-amz-server-side-encryption header set to AES256 in PutObject requests. Combine this with a bucket policy that denies uploads without this header to guarantee data is encrypted at rest.

- Dont use aws:kms in the x-amz-server-side-encryption header. This setting is used for SSE-KMS (encryption with AWS Key Management Service), not for SSE-S3. Since the requirement is for SSE-S3, AES256 should be used.

### 27. Using IAM Policy Variables for User-Specific Access in S3

- To dynamically grant users access to their own folders in S3, use IAM policy variables like ${aws:username}. This approach allows you to create a single policy that automatically adapts for each user, ensuring access control without the need for multiple policies.

### 28. Using AWS Trusted Advisor for Role and Permission Management

- AWS Trusted Advisor provides recommendations on IAM usage, including identifying unused IAM roles. It offers a "Service-Linked Roles" check and other checks that help the team lead identify roles and permissions that haven’t been used, making it easier to manage and remove unnecessary roles without affecting active services.

- To ensure that team members have only the permissions they need, AWS Trusted Advisor is useful for identifying unused IAM roles and permissions, enabling streamlined access management without risking disruption to active services.

### 29. AWS KMS Encryption Process

- AWS KMS keeps the CMK secure within the service. Clients send their data to KMS for encryption, and KMS performs the encryption using the CMK and sends the encrypted data back. This ensures the CMK is never exposed to the client, providing strong security for encryption operations.

### 30. Activating IAM Access for AWS Billing and Cost Management

- In AWS, by default, only the root user has access to the Billing and Cost Management console. To allow IAM users to access billing information, you need to enable IAM access to the Billing and Cost Management console.

- To enable IAM users to view billing information, activate IAM access for the Billing and Cost Management console in the account settings. This step is required even if users have the correct permissions.

### 31. Designing Scalable Image Storage Applications with AWS
- To design a scalable and low-maintenance application for storing and retrieving images:
    - Use Cognito User Pools for user management and API Gateway authorization.
    - Store images in Amazon S3 for scalability and cost-efficiency.
    - Save metadata in DynamoDB for fast lookups.
    - This architecture ensures high performance, seamless scalability, and minimal operational overhead.

### 32. Cognito User Pools

- These help manage user accounts for your app. They handle things like signing up, logging in, and verifying who the user is (authentication). They also support features like password rules and extra security steps (like two-factor authentication). Use them when you want your app to manage user sign-in and secure communication with your backend API.

### 33. Cognito Identity Pools

- These give users temporary access to AWS services like S3 (file storage) or DynamoDB (databases). They don’t handle signing up or logging in but can use already authenticated users from User Pools or external services (like Google or Facebook). Use them if your app needs users to interact directly with AWS services.

### 34. Key Difference between 32 & 33

- User Pools = Manage user accounts and logins.
- Identity Pools = Provide AWS access to users.

### 35. Reusing SSH Key Pairs Across AWS Regions

- To reuse SSH key pairs across AWS Regions, generate a public key from the private key and import it into the required Regions. This approach enables consistent access across Regions while adhering to AWS's Region-specific key pair management. 
- Avoid storing private keys in shared locations like S3, even if encrypted, and follow best practices for secure key management, including encryption, controlled access, and periodic key rotation.

### 36. AWS Systems Manager Parameter Store 

- AWS Systems Manager Parameter Store is the best approach for securely managing and retrieving variables like API authentication information, API URLs, and credentials across environments.
- It keeps this data secure and makes it easy to access it when needed, no matter what environment your app is running in (like development, testing, or production). It’s a safe and organized way to manage sensitive settings.

### 37. API Gateway Authentication

- While AWS STS (Security Token Service) is a service for obtaining temporary security credentials for AWS services, it is not directly used as a mechanism to authenticate API Gateway requests. Instead, API Gateway can use other mechanisms like Lambda Authorizers, IAM roles and policies, or Cognito User Pools to control access

### 38. Sharing CloudFront contents

- If you want to securely share a specific file, you can use CloudFront signed URLs. These URLs allow you to control who can access the file and for how long, keeping them secure. 
- If you need to manage access to many files at once, signed cookies are a better option. it gives secure access to multiple files without creating separate URLs for each one.

### 39. CloudFront Signers

- AWS CloudFront uses key pairs (a private key and a public key) to control access to content. The private key is used by a "signer" (like the account owner, an IAM user, or an application) to create signed URLs or cookies, while the public key, stored in CloudFront, is used to verify and allow access. 
- For security, AWS limits the root user to managing only two active key pairs at a time. These tools help ensure only authorized users can access specific content, like videos or files, for a set time or under certain conditions.

### 40. Storing API Keys Safely with AWS Secrets Manager

- The best way to keep third-party API keys safe is to store them in AWS Secrets Manager, which locks them with encryption, controls who can access them, and can even update them automatically. This keeps your app secure without slowing it down, making it perfect for real-world use. 
- Don’t store API keys in your code or places like S3 or databases, as they aren't as secure.

### 41. Using Cognito Sync for Offline and Cross-Device Synchronization

- For applications requiring offline access and synchronization across multiple devices, Cognito Sync is the best solution.
- Amazon Cognito Sync is an AWS service and client library that enables cross-device syncing of application-related user data. You can use it to synchronize user profile data across mobile devices and the web without requiring your own backend.

### 42. Handling Large Encrypted Data in AWS Lambda

- If you want to pass over 1MB of data to your Lambda functions and needing encryption, Envelope Encryption is the best option.

- What is Envelope Encryption? It uses AWS KMS (Key Management Service) to protect a smaller data key, which then encrypts and decrypts the large data securely and efficiently.

- Why Use File References? Instead of storing the data directly in environment variables (which are limited to 4 KB), the encrypted data is stored as a file. This avoids size limits and makes it easier to work with large datasets.

- How It Works in Lambda: The Lambda function decrypts the data key using KMS and uses that key to unlock the encrypted file during runtime, ensuring both security and performance.

### 43. SQS long polling

- SQS long polling makes retrieving messages from a queue more efficient and cost-effective. Instead of constantly checking for new messages (which can waste resources if the queue is empty), long polling waits until a message arrives or a timeout happens. 
- This reduces the number of unnecessary checks, saving money and making message handling smoother, especially in busy systems.
- Short polling returns immediately, even if no messages are available, resulting in more frequent API requests and higher costs.

### 44. SQS Visibility
- Visibility timeout is used to prevent multiple consumers from processing the same message simultaneously. It does not optimize cost or improve polling efficiency.

- SQS message timers let you delay when a message becomes visible to be processed. For example, if you send a message to the queue but don't want it to be available right away, you can set a timer (delay). During this delay, the message stays in the queue but cannot be read by consumers.

### 45. AWS Systems Manager Parameter Store
- AWS Systems Manager Parameter Store is a secure storage service for saving important settings and secrets, like database passwords, API keys, or configuration details. 

-It lets you access these settings directly from your application whenever needed, instead of hardcoding them. You can update the settings without restarting or redeploying your app, and it keeps the data safe with encryption. It’s a simple way to manage and use your app’s configuration securely.

- To manage your app's settings securely and without redeploying, use AWS Systems Manager Parameter Store. It stores configuration data (like database info or API keys) securely and lets your Elastic Beanstalk app load these settings dynamically while running. This makes it easy to update configurations without stopping or redeploying your app.

### 46. Access Control List (ACL), IAM policies and Resource-based policies
- Access Control Lists (ACLs): ACLs are used to control access at the resource level. For example, S3 bucket ACLs define who can access specific buckets or objects, while Network ACLs (NACLs) manage traffic to and from subnets in a VPC. ACLs are simpler and usually allow or deny access based on IP addresses or AWS accounts.

- IAM Policies: IAM (Identity and Access Management) policies define permissions at the user, group, or role level. These policies are highly flexible and granular, allowing you to specify actions (e.g., s3:GetObject), resources (e.g., a specific bucket), and conditions (e.g., access only from certain IPs). They are used to control access to AWS services and resources globally across an account.

- Resource-based policies are permissions policies attached directly to a resource in AWS. Unlike IAM policies, which are attached to users, groups, or roles, resource-based policies are directly applied to AWS resources like S3 buckets, AWS Lambda functions, or Amazon SNS topics. These policies define who (which users, roles, or accounts) can perform specific actions on the resource and under what conditions.

### 47. AWS partitions

- AWS partitions are groups of AWS regions based on markets or rules. There are three main partitions: **aws** (for most global regions), **aws-cn** (for regions in China), and **aws-us-gov** (for U.S. government regions). 
- Partitions help AWS manage services separately, depending on rules or customer needs. 
- When using AWS resource names (ARNs), the partition shows where the resource belongs, like `arn:aws:s3:::example-bucket` for global, or `arn:aws-cn:s3:::example-bucket` for China.

### 48. Sharing access to S3 between accounts

- Yes, that's correct. IAM policies, Access Control Lists (ACLs), and resource-based policies can control access within the same AWS partition, such as accounts in the standard AWS regions (aws) or within AWS China (aws-cn). However, they do not work across different partitions. For example, you cannot use these policies to share access between an account in the global partition (aws) and one in the China partition (aws-cn) because these partitions are completely separate, with no direct resource-sharing capabilities.

### 49. Cross-account IAM role
- Cross-account IAM roles are a way to securely allow access to resources in one AWS account from another AWS account. Instead of directly granting access to users in another account, you create a role in your account and allow trusted entities (like users or services from the other account) to "assume" that role.

- Cross-account IAM roles let people or apps in one AWS account access S3 buckets in another account. You set up a role in the bucket's account, allow the other account to use it, and give it the right permissions. This works for both programs using code and users logging into the AWS console.

### 50. SSE-KMS: Choosing the Right Encryption Method for S3

- Server-Side Encryption with AWS Key Management Service (SSE-KMS) allows you to encrypt S3 data with Customer Master Keys (CMKs).
- With SSE-KMS, you retain full control over encryption keys, including their creation, rotation, and deletion, which aligns with the requirement of this use case.
- Secrets Manager is designed for managing secrets like database credentials or API keys, not for encrypting S3 bucket data.

### 51. RDS IAM Database Authentication:

- IAM Database Authentication allows users to connect to their Amazon RDS database instance without having to use a password, instead relying on an IAM token. Supported Engines include RDS MySQL and RDS PostgreSQL

### 52. Orchestrating Serverless Workflows with AWS Step Functions

- To manage and orchestrate serverless workflows with parallel tasks, decision points, and Lambda integration, AWS Step Functions state machines provide a powerful and scalable solution.

### 53. Amazon Cognito for Multi-Factor Authentication (MFA):

- Amazon Cognito is designed for user management, including handling user sign-up, sign-in, and account recovery. It supports built-in Multi-Factor Authentication (MFA), eliminating the need to build a custom solution.

### 54. End-to-End Data Security with EBS
- Amazon EBS keeps your data safe by encrypting it in two ways: while it's being transferred (in-flight) using secure connections (TLS) and while it's stored (at rest) using AWS KMS. This means your data is protected at all times, making EBS a great choice for applications that need strong security and compliance.

### 55. Simplified User-Specific Access in S3
- Amazon Cognito gives each user a unique identity prefix, like a personal ID. Using this prefix in an IAM policy, you can ensure that users can only access their specific folders in an S3 bucket. For example, a user with the ID "user123" can only upload or download files from the "user123" folder. This keeps each user's data separate and secure.

### 56. Secrets Manager vs Parameter Store:

- Secrets Manager is designed specifically for managing sensitive information such as access tokens, passwords, and API keys. It supports encryption both at rest and in transit using AWS KMS.
- Parameter Store is better suited for configuration management and lightweight use cases. While it supports secure storage with KMS, it lacks built-in rotation and is less optimized for secrets sharing across accounts.

### 57. Restricting API Gateway Access with CORS

- CORS is a mechanism that allows you to specify which domains are permitted to access your API Gateway.
- By enabling and configuring CORS, you can restrict unauthorized domains from sending requests to your API, effectively reducing costs caused by unauthorized usage.

### 58. CORS
- CORS (Cross-Origin Resource Sharing) is like a security guard for your website. It decides if a website can share data with another website. For example, if your app on website A wants to get information from website B, CORS checks if website B allows it. If allowed, the data is shared; if not, the request is blocked. This helps keep your data safe and prevents unauthorized access between websites.
- The name CORS stands for Cross-Origin Resource Sharing because it deals with sharing resources (like data or files) between different "origins." An origin is basically a combination of a website's URL, including its protocol (e.g., HTTP/HTTPS), domain (e.g., example.com), and port. Normally, browsers block requests between different origins for security.
- CORS is the system that lets websites securely share resources across these origins when allowed, which is why it’s called Cross-Origin Resource Sharing.

### 59. Explicit Deny Overrides All
- In AWS IAM, an explicit deny in any policy always takes precedence over any allow statement, ensuring that critical security controls are enforced regardless of other permissions.

### 60. Access Control in S3
- Amazon S3 access can be controlled using Bucket Policies, IAM Policies, ACLs, and Query String Authentication for time-limited access, enabling flexible and secure management of data access.
- S3 Query String Authentication is a way to give someone temporary access to your files in an S3 bucket without making the files public. You create a special link (a signed URL) that includes a secret key and an expiration time. The person with the link can access the file, but only until the link expires. This is useful for securely sharing files for a limited time.

### 61. CORS And Bucket policies

- CORS issues occur when browsers block cross-origin requests, even if the requester has proper permissions.
- Bucket policy issues arise when AWS accounts, users, or roles lack explicit permissions to access a bucket or objects.
- When troubleshooting access issues, consider if the problem involves browser-enforced restrictions (CORS) or permission management (bucket policies) to apply the correct solution.

### 62. Understanding Authorization Failures with AWS STS
- When developers encounter an "Encoded authorization failure message" in AWS, they can use the AWS Security Token Service (STS) decode-authorization-message API to decode the message. 
- This operation helps developers understand why their request was denied by translating the encoded error message into a human-readable format. It provides details about which IAM policies denied the request.
-  IAM itself does not have a command for decoding error messages. This is handled by AWS STS.

### 63. Always use IAM-generated Git credentials for CodeCommit
- If you want to securely migrate an existing application code repository from GitHub to AWS CodeCommit over HTTPS, you should use Git credentials generated from IAM. 
- AWS CodeCommit provides Git credentials that can be securely generated for individual IAM users. These credentials are specifically designed for HTTPS Git connections to CodeCommit and ensure a secure and straightforward authentication process.
- Using IAM user secret access keys and access key IDs is incorrect for Git operations because those are typically meant for programmatic access to AWS APIs, not for Git over HTTPS.

### 64. S3 Buckets CloudTrail Logs
- If you want to enable object-level logging for all objects in your S3 bucket, ensure that the bucket owner is also the owner of the objects. 
- This can be achieved by enabling the Bucket Owner Enforced setting in the bucket policy or explicitly granting ownership at the time of object upload.

### 65. S3 Buckets CloudTrail Logs
- Using IAM roles for secure EC2 access to AWS resources
If you want your EC2 instance to access AWS resources securely, always create an IAM role with the minimum required permissions, such as AmazonDynamoDBReadOnlyAccess for read-only tasks. 

### 66. Ensuring Secure Communication with S3 Using SSE-C
- If you want to use SSE-C for encryption in S3, always ensure the connection is using HTTPS. This protects customer-provided encryption keys from being transmitted in plaintext, meeting security and compliance requirements for encrypted data communication.
- SSE-C (Server-Side Encryption with Customer-Provided Keys) requires clients to send encryption keys to AWS S3 with every request. If the connection is not using HTTPS, S3 will reject the request because customer-provided keys are sent in plaintext, making HTTPS mandatory for security.
- Other encryption options, like SSE-S3, SSE-KMS, and Client-Side Encryption, don’t have this restriction since the keys are already encrypted or managed differently.

### 67. cloudwatch associate-kms-key
- The aws cloudwatch associate-kms-key command in the AWS CLI is used to enable encryption for CloudWatch Logs by associating a KMS (Key Management Service) key with a log group. This ensures that log data is encrypted using the specified KMS key for enhanced security.
- If you want to encrypt log data for an existing CloudWatch log group, use the associate-kms-key command in AWS CLI and specify the KMS key ARN. This ensures that all future log data in the log group is securely encrypted, meeting compliance and security requirements.

### 68. Proper Header for SSE-KMS with AWS S3
- If you want to use SSE-KMS for encrypting objects in Amazon S3, always include the header `x-amz-server-side-encryption: aws:kms` in your requests. 
- `x-amz-server-side-encryption: aws:kms` explicitly tells S3 to use AWS Key Management Service (KMS) for server-side encryption. Developers may encounter permission errors if the wrong header value is used or if IAM permissions are not set correctly for KMS.
- `x-amz-server-side-encryption: SSE-KMS` is incorrect because SSE-KMS is not a valid header value.

### 69. Correct Headers for SSE-S3 in Amazon S3
If you want to enable server-side encryption with SSE-S3 in Amazon S3, always set the request header to 'x-amz-server-side-encryption': 'AES256'. This ensures that Amazon S3 encrypts your objects using AES-256 encryption, meeting compliance and security requirements efficiently.

### 70. AWS CodeCommit
- Data in AWS CodeCommit repositories is encrypted in transit and at rest. When data is pushed into an AWS CodeCommit repository (for example, by calling git push), AWS CodeCommit encrypts the received data as it is stored in the repository.

### 71. CORS
- CORS (Cross-Origin Resource Sharing): It is a security feature implemented by browsers that allows controlled access to resources hosted on a different domain or origin.
- When your website (main bucket) attempts to access resources (videos) from another bucket, the browser blocks the request due to the Same-Origin Policy. By enabling CORS on the video bucket, you allow the browser to fetch the resources across origins, thus resolving the issue.

### 72. Encryption with Automatic Key Rotation
If you want to implement S3 encryption at rest with annual key rotation easily and efficiently, use AWS KMS with automatic key rotation.

### 73. End-to-End Encryption with AWS CloudFront
- If you want to secure data transmission using HTTPS, configure AWS CloudFront to enable encryption both between clients and CloudFront, and between CloudFront and backend servers. This ensures robust end-to-end security for content delivery.

### 74. Best Practices for EC2 Permissions to S3
- If you want your EC2 instances to securely access and interact with S3, always create and attach an IAM Role with specific permissions. This ensures secure and temporary access without hardcoding credentials, aligning with AWS best practices.

### 75. AWS Stops
- AWS STS (Security Token Service) is a service that provides temporary, short-term security credentials for AWS resources. These credentials include an access key, a secret key, and a session token, and they are commonly used to grant limited, time-based access to AWS accounts or resources.
- AWS Security Token Service (STS) provides temporary credentials with a default expiration time of 1 hour. If the application does not handle credential renewal, it will lose access to AWS resources after the temporary credentials expire.

### 76. Use IAM Roles for EC2 Instances to Securely Access AWS Services
- For secure and seamless access to AWS resources, use IAM roles rather than IAM users for EC2 instances. Roles eliminate the need for storing credentials on the instance and ensure automatic credential rotation, thereby enhancing security and reducing management overhead.

### 77. Use Minimal Permissions for Lambda Functions
- The S3ReadPolicy is the appropriate managed policy to provide read-only access to S3 buckets. 
- When deploying Lambda functions that need to read files or extract metadata from S3 buckets, attaching this policy ensures the function can perform operations like GetObject and ListBucket without unnecessary write or delete permissions, adhering to the principle of least privilege.

### 78. Choose the Right Encryption Option for Your Use Case
- When dealing with data encryption in AWS S3, select the encryption method based on who manages the keys and where the encryption occurs. For customer-managed keys with server-side encryption, use SSE-C.

### 79. Root Account Usage
- Enable Multi-factor Authentication (MFA): This adds an additional layer of security, requiring a second form of authentication (e.g., a code from a mobile device) to log in.
- Minimize Access: Only one admin should have access to the root account credentials. Everyday administrative tasks should be performed using IAM roles or users with the necessary permissions, not the root user.

### 80. CORS and 403:
- CORS error and a 403 error look different.
- 403 (Access Denied): This is an AWS permission issue and is shown as an HTTP response. A 403 (Access Denied) error for S3 is always related to insufficient permissions or access restrictions on the bucket or object. It means the request was blocked by AWS's permission system, such as Bucket Policy or Object ACL.
- CORS Error happens after the server allows access to the resource, but the browser blocks it due to missing CORS headers. CORS issues do not return an HTTP response like 403 but show up as JavaScript errors in the browser console.
- If you're seeing a 403 (Access Denied) from S3, it's definitely a permissions issue, not a CORS problem.

### 81. IAM and 403 error
- IAM role is used to grant temporary, controlled access to AWS resources for services, applications, or users. For example, an application running on EC2 can assume an IAM role to access an S3 bucket or other AWS services without needing long-term credentials.
- However, IAM roles are not meant for allowing public access to an S3 bucket. Public access for static website hosting requires:
    - bucket policy that explicitly allows public read access to the objects in the bucket.
    - Ensuring public access settings are enabled at the bucket or account level (by disabling "Block Public Access" if necessary).

### 82. API Gateway and STS
- While STS can be used to obtain temporary credentials, it is not directly supported as a mechanism for controlling access to API Gateway. 
- API Gateway supports various access control mechanisms, such as IAM permissions with Signature Version 4 (SigV4), Lambda authorizers, and Amazon Cognito User Pools. However, Security Token Service (STS) is not a mechanism directly supported for controlling access to API Gateway endpoints.

### 83. CodeBuild artifacts encryption
- When working with AWS CodeBuild, you can ensure that your build artifacts are automatically encrypted by specifying a Customer Master Key (CMK) from AWS Key Management Service (KMS). 
- CodeBuild will use this key to encrypt the build artifacts before storing them in the specified location.

### 84. AWS X-Ray across multiple accounts
- To enable unified X-Ray trace collection across multiple AWS accounts, set up a unified account as the central account to view all traces. Create an IAM role in the unified account and allow sub-accounts to assume this role so they can send their X-Ray data to the central account. 
- In each sub-account, ensure the X-Ray daemon runs with an IAM instance role that has the necessary permissions to write trace data to X-Ray.

### 85. Configuring Secure HTTPS and HTTP Redirection
- If you want your Elastic Beanstalk environment to support secure HTTPS connections and redirect all HTTP traffic to HTTPS, you need to open ports 80 and 443, configure HTTP to HTTPS redirection on EC2 instances, and assign an SSL certificate to the Load Balancer.

### 86. Amazon Macie, SensitiveData:S3Object/Financial
- Amazon Macie is ideal for identifying sensitive financial data in S3 buckets. It uses machine learning to detect and classify data, like customer financial information, directly from the output of daily batch jobs. 
- By leveraging Macie’s predefined detection type, SensitiveData:S3Object/Financial, you can efficiently analyze S3 data without the need for custom scripts or user-defined patterns
- SensitiveData:S3Object/CustomIdentifier in Amazon Macie is used when you need to detect sensitive data based on user-defined patterns or criteria that Macie does not natively support.
However, in the case of financial data, Macie already provides predefined detection capabilities under SensitiveData:S3Object/Financial, making it unnecessary to create custom identifiers.

### 87. S3 and DynamoD gateway endpoints
- Use gateway endpoints for S3 and DynamoDB when enabling private connectivity from VPC subnets to these services. Configure route tables to direct traffic for these services through their respective gateway endpoints for secure, efficient, and cost-effective access.
- For AWS services other than S3 and DynamoDB, you need Interface Endpoints (powered by AWS PrivateLink) to connect your VPC privately without using the internet.

### 88. Use Cache Behaviors for Path-Specific Access
- To allow unauthenticated access to a login page while keeping strict access to other private S3 content, configure a second cache behavior in your CloudFront distribution. Set a path pattern (e.g., /login) for the login page and make its viewer access policy unrestricted, ensuring unauthenticated users can access it. 
- For all other content, retain the default cache behavior with restricted access using the Origin Access Identity (OAI) to protect private content. This setup ensures secure and selective access.

### 89. Optimize AWS KMS Usage for High-Volume Applications
- The ThrottlingException occurs when the application exceeds the AWS KMS request limits, which typically happens with a large volume of encryption or decryption requests. 
- To optimize AWS KMS for high-volume applications, use data key caching with the AWS Encryption SDK to reduce frequent KMS requests and implement backoff and retry logic to handle throttling by delaying and retrying failed requests.

### 90. Simplify Authentication with ALB and Cognito
- For minimal development effort and effective decoupling of authentication logic, use *Application Load Balancer’s* native integration with Cognito User Pools.
- CloudFront does not natively support integration with Cognito User Pools for authentication. You would need additional configurations, such as using Lambda@Edge or custom API Gateway implementations, which increases development complexity compared to using ALB.

### 91. Enforce Secure Access to S3 with Bucket Policies
- HTTPS provides encryption in transit. It secures the data sent between your browser (or application) and the server by encrypting it.
- To ensure secure access(i.e encription in transit) to sensitive data stored in Amazon S3, configure a resource-based policy on the S3 bucket to deny access for requests made without HTTPS by using the "aws:SecureTransport": "false" condition. 
- i.e. Configure a resource-based policy on the S3 bucket to deny access when a request has the condition "aws:SecureTransport": "false".

### 92. SSL termination
- SSL termination is when encrypted traffic (HTTPS) from a user is decrypted at a specific point, like a load balancer or proxy server, instead of the backend server. 
- This means the load balancer handles the secure connection, making it easier for the backend server since it doesn't need to deal with encryption. 

### 93. Offload SSL Processing to ALB
- Handling HTTPS traffic involves encrypting and decrypting SSL/TLS connections, which can increase the CPU load on web servers. 
- Offloading this task to an Application Load Balancer (ALB) with SSL termination reduces the computational burden on EC2 instances. 
- AWS Certificate Manager (ACM) simplifies the process of managing SSL/TLS certificates by automating their provisioning and renewal.

### 94. Simplified Server-Side Encryption with SSE-S3
- For meeting regulatory requirements involving AES-256 encryption without managing keys, SSE-S3 is the optimal choice. 
- It provides secure server-side encryption while offloading key management to Amazon S3, ensuring ease of use and compliance.

### 95. Kinesis Security Without Code Changes
- If you want to enforce stricter security requirements by leveraging mechanisms available with the Kinesis Data Streams service that won't require code changes, you should enable KMS encryption for data at rest to protect stored data and configure encryption in flight with HTTPS endpoint to secure data during transmission.

### 96. EBS volumes encryption
- A volume restored from an encrypted snapshot, or a copy of an encrypted snapshot, is always encrypted.
- Encryption by default is a Region-specific setting. If you enable it for a Region, you cannot disable it for individual volumes or snapshots in that Region.

### 97. S3 Pre-signed URLs
- Pre-signed URLs are a secure way to grant temporary access to private objects stored in an S3 bucket. When an S3 bucket is private, objects cannot be accessed via public URLs. 
- However, using a pre-signed URL allows you to define an expiration time, giving temporary access to specific objects for users without exposing the bucket to public access.

### 98. Cognito Identity Pools vs. Web Identity Federation
- Cognito Identity Pools and Web Identity Federation are related but not exactly the same:
    - Web Identity Federation: A general AWS feature that allows users to authenticate via third-party identity providers (like Google, Facebook, or OpenID Connect) and obtain temporary AWS credentials through AWS STS.
    - Cognito Identity Pools: A service built on top of Web Identity Federation that simplifies the process. It manages the integration with third-party identity providers, generates temporary AWS credentials, and provides additional features like anonymous access, multi-provider support, and user-specific permissions.

### 99. Managing Cross-Account Access in AWS
- Use IAM roles with cross-account permissions to securely enable other AWS accounts to access your resources.

### 100. Securing Database Credentials with AWS Parameter Store
- Use AWS Systems Manager Parameter Store with SecureString parameters to securely manage sensitive information like database connection strings. This ensures scalability, encryption, and seamless integration with AWS services.

### 101. Securing S3 Uploads with SSE
- When uploading an object to S3 using the REST API, you can ensure the data is encrypted using Server-Side Encryption (SSE) by including the x-amz-server-side-encryption header in your request. This header allows you to specify the desired encryption method (e.g., AES256 or aws:kms) to protect your data.

### 102. Centralized Key Management with AWS KMS
Use AWS KMS for centralized encryption key management and automatic key rotation in SQS.

### 103. Secure Token Management with Secrets Manager
- Use AWS Secrets Manager to securely store and manage sensitive data like access tokens, ensuring minimal management overhead, automated secret rotation, and seamless integration with AWS services.

### 104. AssumeRoleWithWebIdentity API call
- The AssumeRoleWithWebIdentity API call is used to assume a role with temporary security credentials after a successful authentication via a web identity provider such as Google, Facebook, or Amazon Cognito.
- It returns an access key ID, a secret access key, and a security token as temporary security credentials. These credentials can be used by applications to sign calls for AWS service API operations. 

### 105. Granting Lambda Access to DynamoDB
- To enable a Lambda function to interact with a DynamoDB table, you need to configure the function’s execution role with an IAM policy that grants the required permissions, such as dynamodb:ReadItem or dynamodb:PutItem

### 106. Use IAM Policy Simulator for Permission Testing
- The IAM Policy Simulator is an effective tool for testing and troubleshooting permissions associated with IAM roles, policies, and users. It helps validate whether a role or user has the necessary permissions to perform specific actions on AWS resources.

### 107. Amazon Cognito for managing device tracking
- Amazon Cognito lets developers track and manage the devices users use to access an application. It can register devices, store device metadata, and enforce rules like limiting the number of devices per user.
- Device tracking in Amazon Cognito is a feature of Cognito User Pools, which are used for user authentication and management. With device tracking, Cognito can remember and manage the devices users log in from.

### 108. AWS Image Builder for AMI Creation
- AWS Image Builder simplifies the process of creating and managing custom AMIs by automating updates, security patches, and configurations. 
- This ensures consistency, scalability, and efficiency when launching EC2 instances, especially in auto-scaling environments.

### 109. Amazon ElastiCache for Session State Management
- If you want to prevent users from losing their sessions when an instance fails, store session state in Amazon ElastiCache, then disable sticky sessions. 
- By storing session state in ElastiCache, you decouple the session management from individual EC2 instances, ensuring that users’ sessions persist even if an instance fails. Disabling sticky sessions further allows load balancers to evenly distribute traffic among instances without tying users to a specific server.

### 110. Amazon Macie and SSE-KMS for PII Management and Encryption
- If you want to identify and protect files containing personally identifiable information (PII) in S3, use Amazon Macie to detect sensitive data and encrypt it with SSE-KMS. This solution allows the security team to manage and **rotate encryption keys automatically**, ensuring compliance and enhancing data security.

### 111.  Envelope Encryption for Enhanced Key Security
- If you want to ensure that your data encryption keys are securely managed, use envelope encryption. This technique encrypts the data key with a master key, ensuring that the sensitive data remains secure even if the data key is exposed. 
- AWS KMS supports envelope encryption, simplifying the management of master keys and data keys.
- Envelope encryption is a technique where data is encrypted using a data key, and then the data key itself is encrypted using another key (usually a master key). This method enhances security by ensuring that the encryption keys are themselves protected. AWS Key Management Service (KMS) supports envelope encryption.

### 112. AWS Athena for CloudTrail Log Analysis
- AWS CloudTrail logs API activity in an account and stores these logs in S3. Athena is an AWS service that allows you to run SQL queries directly on data stored in S3 without requiring a database setup.
- If you want to analyze API activity from CloudTrail logs, use AWS Athena. Athena enables efficient SQL querying of log data stored in S3, allowing you to filter and analyze API actions by specific IAM users or time ranges without additional data transformation steps.

### 113. Amazon Cognito Identity Pools for Guest User Access
- If you want to provide guest users with temporary access to AWS resources during a trial period, use Cognito identity pools. This service enables anonymous access and seamlessly integrates with AWS resources, making it ideal for applications requiring guest user access without requiring full user authentication.

### 114. Using Key Policies and IAM Roles for KMS Decryption
- To let EC2 instances decrypt KMS-encrypted files, ensure the KMS key policy grants access to the EC2 instance role. 
- Also, configure the instance role with the necessary decryption permissions (kms:Decrypt). 

### 115. Default Encryption for Amazon S3 Buckets
- If you want to secure data at rest in S3, use default encryption. It ensures that all objects in the bucket are encrypted automatically using server-side encryption with minimal management effort.

### 116. Enforcing KMS Encryption in S3 Using Bucket Policies
- If you want to enforce object encryption using AWS KMS in S3, configure a bucket policy to deny PUT operations unless the request includes the x-amz-server-side-encryption: aws:kms header. This ensures that all uploaded objects comply with the encryption requirements.

### 117. AWS Encryption SDK for Client-Side Encryption
- If you want to encrypt sensitive data on the client side before uploading it to S3, use the AWS Encryption SDK.
- AWS Encryption SDK is a client-side encryption library that allows you to encrypt files locally before uploading them to Amazon S3. It provides tools for managing encryption keys and performing encryption and decryption tasks, ensuring sensitive data is protected while in transit and at rest.
- The AWS Encryption SDK helps encrypt files securely by using AWS KMS to manage keys. When encrypting a file, the SDK creates a data key, encrypts the file with it, and also encrypts the data key using a KMS key. This ensures both the file and the key are protected. Later, to decrypt the file, the SDK uses KMS to unlock the data key and then decrypts the file. It’s a simple and secure way to handle file encryption and decryption.

### 118. Encrypting Existing AMIs in AWS
- If you want to encrypt existing AMIs, create a copy of each AMI and enable encryption during the copy process. This approach ensures that the copied AMI is encrypted with a KMS key while adhering to AWS security policies. Delete the unencrypted AMIs to maintain compliance and security.

### 119.  Granting Access to Lambda for DynamoDB
- If you want a Lambda function to access a DynamoDB table, create an IAM access policy with the necessary permissions (e.g., dynamodb:GetItem). Attach the policy to the Lambda execution role. This ensures the function can securely access the table without running into permission issues.

### 120. IAM Roles for Secure and Automated Permissions
- If you want to securely grant application on an Amazon EC2 instance that requires access to an Amazon S3 bucket, use IAM roles. They eliminate the need for managing or sharing credentials manually. Create a role that includes policies that grant read permissions to the bucket and attach it to the EC2 instance.

### 121. Amazon DynamoDB and PutItem for Replacing Data
- If you want to replace an entire item in a DynamoDB table, use the PutItem API. It efficiently creates a new item or completely overwrites an existing one when the primary key matches. 
- UpdateItem API modifies specific attributes of an existing item but does not replace the entire item. It is not suitable for replacing the item entirely.
- UpdateTable API call is used for modifying table-level settings, such as throughput or indexes, and not for modifying items.

### 122. IAM Roles for Secure and Automated Credentials Management
- If you want to securely manage access for applications to AWS resources with minimal administrative overhead, use IAM roles. They provide temporary, automatically **rotated security tokens**.
- They also simplify secure API access without hardcoding or manual credential management.

### 123. Enforcing Secure Connections in S3 Policies
- If you want to enforce secure connections for S3 bucket access, use the aws:SecureTransport condition key in your bucket policy. This ensures that only HTTPS requests are allowed, enhancing the security of your data transfers.
- To ensure S3 objects are accessed securely, use the aws:SecureTransport condition in the bucket policy. This condition denies s3:GetObject requests when aws:SecureTransport is false, forcing all access to use HTTPS instead of HTTP. This improves security by preventing unencrypted data transfers. Other conditions, like encryption requirements, are not part of this policy.

### 124. Secure Transport vs. Encryption
- Secure Transport (HTTPS - aws:SecureTransport): Ensures data is transmitted securely over the internet by encrypting it during transit. Using HTTPS instead of HTTP prevents data from being intercepted while traveling between a client and AWS S3.
- Encryption (Server-Side or Client-Side): Protects data at rest by encrypting it when stored in S3. This ensures that even if someone gains access to the stored data, they cannot read it without the decryption key.

### 125. Security Group Rules for Resource Communication
- If you want resources like Amazon EMR and RDS to communicate, configure their security groups with the necessary inbound and outbound rules based on specific ports and IP ranges while maintaining security.
### 126. EC2 Image Builder for Secure AMI Creation and Distribution
- If you want to create encrypted AMIs with the latest security updates and distribute them across AWS Regions, use EC2 Image Builder. 

### 127. IAM Permissions for DynamoDB GetItem
- The GetItem operation retrieves an item from DynamoDB using its primary key. If a developer gets a "permission denied" error, their IAM role or user likely lacks the dynamodb:GetItem permission. 
- The ListTables permission, which allows listing all tables, is unrelated and does not affect GetItem access. To fix this, ensure the IAM policy explicitly grants dynamodb:GetItem on the required table.

### 128. Enabling HTTPS for S3 with a Custom Domain
- S3 buckets do not support HTTPS directly when using a custom domain. To enable HTTPS, set up an Amazon CloudFront distribution in front of your S3 static website. CloudFront allows you to use an SSL/TLS certificate from AWS Certificate Manager (ACM), ensuring secure communication while keeping your custom domain intact.

### 129. Why S3 Doesn't Support HTTPS Directly with a Custom Domain
- S3 supports HTTPS when accessed using its default S3 URL (e.g., https://bucket-name.s3.amazonaws.com). However, when using a custom domain, you need to use Amazon CloudFront because:
    - No Native SSL for Custom Domains: S3 does not allow you to attach SSL/TLS certificates for custom domains, meaning you cannot serve HTTPS traffic directly.
    - S3 Static Website Endpoints Only Support HTTP: If you enable S3’s static website hosting, it only works over HTTP, not HTTPS.
    - CloudFront Acts as a Secure Proxy: CloudFront allows you to use AWS Certificate Manager (ACM) to enable HTTPS for your custom domain while caching and optimizing content delivery.

### 130. SSE-KMS for Secure Data Encryption
- If you want to encrypt S3 bucket data with automatically rotating encryption keys, use SSE-KMS with a KMS key.

### 131. Key Rotation: SSE-KMS vs. Secrets Manager
- Both SSE-KMS and Secrets Manager handle key rotation, but they serve different purposes:
    - SSE-KMS (AWS Key Management Service): Manages encryption keys for data encryption (e.g., encrypting S3 objects, EBS volumes, or DynamoDB data). KMS automatically rotates customer-managed keys (CMKs) every year if enabled.
    - AWS Secrets Manager: Rotates secrets like database passwords, API keys, or credentials. It automates secret updates and integrates with services like RDS to rotate credentials without manual intervention.
    - Key Difference: SSE-KMS rotates encryption keys for securing stored data, while Secrets Manager rotates credentials and secrets for authentication.

### 131. Application Load Balancer for Secure Web Traffic
- Use an Application Load Balancer (ALB) for web applications that need path-based routing and traffic encryption. Deploying SSL certificates on the ALB ensures secure communication while offloading SSL termination from EC2 instances, improving performance. Unlike a Network Load Balancer (NLB), which lacks path-based routing, ALB provides better flexibility and centralized certificate management, simplifying security and maintenance.
- SSL on EC2 instances increases management overhead and lacks centralized certificate management, making it less efficient.